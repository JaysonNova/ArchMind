# å›½é™…åŒ– (i18n) å®ç°æ–‡æ¡£

## æ¦‚è¿°

ArchMind AI å·²å®Œæˆå›½é™…åŒ–æ”¯æŒï¼Œç°æ”¯æŒ**ç®€ä½“ä¸­æ–‡ (zh-CN)** å’Œ**è‹±æ–‡ (en)** ä¸¤ç§è¯­è¨€ï¼Œå¹¶æä¾›ä¸€é”®åˆ‡æ¢åŠŸèƒ½ã€‚

## æŠ€æœ¯æ¶æ„

### æ ¸å¿ƒä¾èµ–

- **@nuxtjs/i18n** (v10.2.1) - Nuxt 3 å®˜æ–¹ i18n æ¨¡å—
- **vue-i18n** - Vue 3 å›½é™…åŒ–åº“ï¼ˆé€šè¿‡ @nuxtjs/i18n è‡ªåŠ¨é›†æˆï¼‰

### é…ç½®æ–‡ä»¶

#### 1. Nuxt é…ç½® (`nuxt.config.ts`)

```typescript
export default defineNuxtConfig({
  modules: [
    '@nuxtjs/i18n'
  ],

  i18n: {
    locales: [
      {
        code: 'en',
        name: 'English',
        file: 'en.json'
      },
      {
        code: 'zh-CN',
        name: 'ç®€ä½“ä¸­æ–‡',
        file: 'zh-CN.json'
      }
    ],
    defaultLocale: 'zh-CN',
    strategy: 'no_prefix',
    langDir: 'lang',
    lazy: true,
    detectBrowserLanguage: {
      useCookie: true,
      cookieKey: 'i18n_locale',
      redirectOn: 'root',
      alwaysRedirect: false
    },
    compilation: {
      strictMessage: false,
      escapeHtml: false
    }
  }
})
```

**é…ç½®è¯´æ˜:**
- `defaultLocale: 'zh-CN'` - é»˜è®¤è¯­è¨€ä¸ºç®€ä½“ä¸­æ–‡
- `strategy: 'no_prefix'` - ä¸åœ¨ URL ä¸­æ·»åŠ è¯­è¨€å‰ç¼€
- `lazy: true` - æŒ‰éœ€åŠ è½½è¯­è¨€æ–‡ä»¶
- `langDir: 'lang'` - ç¿»è¯‘æ–‡ä»¶ç›®å½•ï¼ˆæ³¨ï¼š@nuxtjs/i18n ä¼šè‡ªåŠ¨åœ¨å‰é¢åŠ ä¸Š `i18n/`ï¼Œæœ€ç»ˆè·¯å¾„ä¸º `i18n/lang/`ï¼‰
- `detectBrowserLanguage.useCookie: true` - ä½¿ç”¨ Cookie æŒä¹…åŒ–è¯­è¨€è®¾ç½®

## ç¿»è¯‘æ–‡ä»¶ç»“æ„

### ç›®å½•ç»“æ„

**é‡è¦ï¼š**ç¿»è¯‘æ–‡ä»¶å¿…é¡»æ”¾åœ¨ `i18n/lang/` ç›®å½•ä¸‹ï¼Œè€Œä¸æ˜¯ `lang/`ã€‚è¿™æ˜¯å› ä¸º @nuxtjs/i18n æ¨¡å—ä¼šè‡ªåŠ¨åœ¨ `langDir` é…ç½®å‰æ·»åŠ  `i18n/` å‰ç¼€ã€‚

```
i18n/
â””â”€â”€ lang/
    â”œâ”€â”€ en.json       # è‹±æ–‡ç¿»è¯‘
    â””â”€â”€ zh-CN.json    # ç®€ä½“ä¸­æ–‡ç¿»è¯‘
```

### ç¿»è¯‘é”®ç»“æ„

```json
{
  "app": {
    "name": "åº”ç”¨åç§°"
  },
  "nav": {
    "home": "å¯¼èˆªé¡¹",
    "documents": "...",
    ...
  },
  "common": {
    "save": "é€šç”¨ï¿½ï¿½ï¿½ä½œæ–‡æœ¬",
    ...
  },
  "projects": {
    "title": "é¡µé¢çº§æ–‡æœ¬",
    "stats": {
      "totalPRDs": "åµŒå¥—ç»“æ„"
    }
  }
}
```

## ä½¿ç”¨æ–¹æ³•

### 1. åœ¨ Vue æ¨¡æ¿ä¸­ä½¿ç”¨

#### åŸºæœ¬ç”¨æ³•

```vue
<template>
  <h1>{{ $t('page.title') }}</h1>
  <p>{{ $t('common.description') }}</p>
</template>
```

#### å¸¦å‚æ•°çš„ç¿»è¯‘

```vue
<template>
  <p>{{ $t('message.greeting', { name: userName }) }}</p>
</template>
```

ç¿»è¯‘æ–‡ä»¶:
```json
{
  "message": {
    "greeting": "Hello, {name}!"
  }
}
```

### 2. åœ¨ Script ä¸­ä½¿ç”¨

```vue
<script setup lang="ts">
const { t } = useI18n()

// åœ¨å‡½æ•°ä¸­ä½¿ç”¨
function showAlert() {
  alert(t('common.error'))
}

// åœ¨è®¡ç®—å±æ€§ä¸­ä½¿ç”¨
const pageTitle = computed(() => t('page.title'))
</script>
```

### 3. è¯­è¨€åˆ‡æ¢

#### ä½¿ç”¨è¯­è¨€åˆ‡æ¢ç»„ä»¶

```vue
<template>
  <LanguageSwitcher />
</template>
```

#### ç¼–ç¨‹å¼åˆ‡æ¢

```vue
<script setup lang="ts">
const { setLocale, locale } = useI18n()

function switchLanguage(lang: string) {
  setLocale(lang)
}

// å½“å‰è¯­è¨€
console.log(locale.value) // 'zh-CN' æˆ– 'en'
</script>
```

## å·²å®ç°çš„åŠŸèƒ½

### âœ… æ ¸å¿ƒåŠŸèƒ½
- [x] @nuxtjs/i18n æ¨¡å—é›†æˆ
- [x] ä¸­è‹±æ–‡ç¿»è¯‘æ–‡ä»¶ (en.json, zh-CN.json)
- [x] Cookie æŒä¹…åŒ–è¯­è¨€è®¾ç½®
- [x] æµè§ˆå™¨è¯­è¨€æ£€æµ‹

### âœ… UI ç»„ä»¶
- [x] LanguageSwitcher ç»„ä»¶ (åŸºäº shadcn/ui Select)
- [x] é›†æˆåˆ° default å’Œ dashboard å¸ƒå±€

### âœ… é¡µé¢ç¿»è¯‘
- [x] é¦–é¡µ (index.vue) - é¡¹ç›®åˆ—è¡¨
- [x] ç”Ÿæˆé¡µé¢ (generate.vue) - PRD ç”Ÿæˆ
- [x] è®¾ç½®é¡µé¢ (settings.vue) - AI æ¨¡å‹é…ç½®
- [x] æ–‡æ¡£é¡µé¢ (documents/index.vue) - æ–‡æ¡£ç®¡ç†

### âœ… ç»„ä»¶ç¿»è¯‘
- [x] Navigation (default.vue, dashboard.vue)
- [x] DocumentUpload
- [x] MessageInput
- [x] Breadcrumbs
- [x] Stats cards
- [x] Error messages

## æ·»åŠ æ–°ç¿»è¯‘

### æ­¥éª¤

1. **åœ¨ç¿»è¯‘æ–‡ä»¶ä¸­æ·»åŠ é”®å€¼**

ç¼–è¾‘ `i18n/lang/zh-CN.json`:
```json
{
  "newFeature": {
    "title": "æ–°åŠŸèƒ½æ ‡é¢˜",
    "description": "æ–°åŠŸèƒ½æè¿°"
  }
}
```

ç¼–è¾‘ `i18n/lang/en.json`:
```json
{
  "newFeature": {
    "title": "New Feature Title",
    "description": "New feature description"
  }
}
```

2. **åœ¨ç»„ä»¶ä¸­ä½¿ç”¨**

```vue
<template>
  <h2>{{ $t('newFeature.title') }}</h2>
  <p>{{ $t('newFeature.description') }}</p>
</template>
```

## æœ€ä½³å®è·µ

### 1. ç¿»è¯‘é”®å‘½åè§„èŒƒ

- ä½¿ç”¨ **camelCase** å‘½å
- ä½¿ç”¨ **å±‚çº§ç»“æ„** ç»„ç»‡ç¿»è¯‘é”®
- é¿å…è¿‡é•¿çš„åµŒå¥—ï¼ˆæœ€å¤š 3-4 å±‚ï¼‰

```json
// âœ… æ¨è
{
  "user": {
    "profile": {
      "edit": "ç¼–è¾‘èµ„æ–™"
    }
  }
}

// âŒ ä¸æ¨è
{
  "user_profile_edit_button_label_text": "ç¼–è¾‘èµ„æ–™"
}
```

### 2. å‚æ•°åŒ–ç¿»è¯‘

ä½¿ç”¨å‘½åå‚æ•°è€Œä¸æ˜¯ä½ç½®å‚æ•°:

```json
// âœ… æ¨è
{
  "message": "Welcome, {name}! You have {count} notifications."
}

// âŒ ä¸æ¨è
{
  "message": "Welcome, %s! You have %d notifications."
}
```

### 3. å¤æ•°å¤„ç†

å¯¹äºéœ€è¦å¤æ•°å½¢å¼çš„ç¿»è¯‘ï¼Œä½¿ç”¨ i18n çš„å¤æ•°è§„åˆ™:

```json
{
  "items": "no items | 1 item | {count} items"
}
```

ä½¿ç”¨:
```vue
{{ $t('items', count) }}
```

### 4. æ—¥æœŸå’Œæ•°å­—æ ¼å¼åŒ–

ä½¿ç”¨ vue-i18n çš„æ ¼å¼åŒ–å·¥å…·:

```vue
<script setup>
const { d, n } = useI18n()

// æ—¥æœŸæ ¼å¼åŒ–
const formattedDate = d(new Date(), 'long')

// æ•°å­—æ ¼å¼åŒ–
const formattedNumber = n(1000, 'currency')
</script>
```

## è¯­è¨€æŒä¹…åŒ–

è¯­è¨€é€‰æ‹©ä¼šè‡ªåŠ¨ä¿å­˜åˆ° Cookie (`i18n_locale`)ï¼Œä¸‹æ¬¡è®¿é—®æ—¶è‡ªåŠ¨æ¢å¤ç”¨æˆ·çš„è¯­è¨€åå¥½ã€‚

### Cookie é…ç½®

- **åç§°**: `i18n_locale`
- **å€¼**: `zh-CN` æˆ– `en`
- **æœ‰æ•ˆæœŸ**: 365 å¤©ï¼ˆé»˜è®¤ï¼‰
- **ä½œç”¨åŸŸ**: å…¨å±€

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: ç¿»è¯‘ä¸æ˜¾ç¤º

**å¯èƒ½åŸå› :**
- ç¿»è¯‘é”®æ‹¼å†™é”™è¯¯
- ç¿»è¯‘æ–‡ä»¶ JSON æ ¼å¼é”™è¯¯
- æœªåœ¨ i18n/lang ç›®å½•ä¸­æ·»åŠ ç¿»è¯‘æ–‡ä»¶

**è§£å†³æ–¹æ¡ˆ:**
1. æ£€æŸ¥ç¿»è¯‘é”®æ˜¯å¦æ­£ç¡®
2. éªŒè¯ JSON è¯­æ³•
3. ç¡®è®¤æ–‡ä»¶è·¯å¾„ï¼š`i18n/lang/en.json` å’Œ `i18n/lang/zh-CN.json`

### é—®é¢˜ 2: è¯­è¨€åˆ‡æ¢ä¸ç”Ÿæ•ˆ

**å¯èƒ½åŸå› :**
- Cookie è¢«ç¦ç”¨
- æµè§ˆå™¨ç¼“å­˜é—®é¢˜

**è§£å†³æ–¹æ¡ˆ:**
1. ç¡®ä¿æµè§ˆå™¨å…è®¸ Cookie
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’Œ Cookie
3. æ£€æŸ¥ `nuxt.config.ts` ä¸­çš„ `detectBrowserLanguage` é…ç½®

### é—®é¢˜ 3: å¼€å‘ç¯å¢ƒçƒ­æ›´æ–°å¤±è´¥

**è§£å†³æ–¹æ¡ˆ:**
ä¿®æ”¹ç¿»è¯‘æ–‡ä»¶åï¼Œé‡å¯å¼€å‘æœåŠ¡å™¨ï¼š
```bash
pnpm dev
```

## æ‰©å±•è¯­è¨€æ”¯æŒ

è¦æ·»åŠ æ–°è¯­è¨€ï¼ˆä¾‹å¦‚ç¹ä½“ä¸­æ–‡ï¼‰ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

### 1. æ·»åŠ è¯­è¨€é…ç½®

ç¼–è¾‘ `nuxt.config.ts`:
```typescript
i18n: {
  locales: [
    { code: 'en', name: 'English', file: 'en.json' },
    { code: 'zh-CN', name: 'ç®€ä½“ä¸­æ–‡', file: 'zh-CN.json' },
    { code: 'zh-TW', name: 'ç¹é«”ä¸­æ–‡', file: 'zh-TW.json' } // æ–°å¢
  ]
}
```

### 2. åˆ›å»ºç¿»è¯‘æ–‡ä»¶

åˆ›å»º `i18n/lang/zh-TW.json` å¹¶æ·»åŠ æ‰€æœ‰ç¿»è¯‘é”®ã€‚

### 3. æ›´æ–°è¯­è¨€åˆ‡æ¢å™¨

ç¼–è¾‘ `components/common/LanguageSwitcher.vue`:
```vue
<SelectContent>
  <SelectItem value="zh-CN">
    <div class="flex items-center gap-2">
      <span>ğŸ‡¨ğŸ‡³</span>
      <span>ç®€ä½“ä¸­æ–‡</span>
    </div>
  </SelectItem>
  <SelectItem value="zh-TW">
    <div class="flex items-center gap-2">
      <span>ğŸ‡¹ğŸ‡¼</span>
      <span>ç¹é«”ä¸­æ–‡</span>
    </div>
  </SelectItem>
  <SelectItem value="en">
    <div class="flex items-center gap-2">
      <span>ğŸ‡ºğŸ‡¸</span>
      <span>English</span>
    </div>
  </SelectItem>
</SelectContent>
```

## æ€§èƒ½ä¼˜åŒ–

### 1. æ‡’åŠ è½½

å·²å¯ç”¨æ‡’åŠ è½½ (`lazy: true`)ï¼Œè¯­è¨€æ–‡ä»¶ä»…åœ¨éœ€è¦æ—¶åŠ è½½ã€‚

### 2. ä»£ç åˆ†å‰²

è¯­è¨€æ–‡ä»¶è‡ªåŠ¨è¿›è¡Œä»£ç åˆ†å‰²ï¼Œä¸ä¼šå½±å“åˆå§‹åŠ è½½æ€§èƒ½ã€‚

### 3. ç¼“å­˜ç­–ç•¥

ç¿»è¯‘æ•°æ®åœ¨å®¢æˆ·ç«¯ç¼“å­˜ï¼Œé¿å…é‡å¤è¯·æ±‚ã€‚

## API å‚è€ƒ

### useI18n() Composable

```typescript
const {
  t,              // ç¿»è¯‘å‡½æ•°
  locale,         // å½“å‰è¯­è¨€ (ref)
  setLocale,      // è®¾ç½®è¯­è¨€
  d,              // æ—¥æœŸæ ¼å¼åŒ–
  n,              // æ•°å­—æ ¼å¼åŒ–
  availableLocales // å¯ç”¨è¯­è¨€åˆ—è¡¨
} = useI18n()
```

### æ¨¡æ¿ä¸­çš„å…¨å±€å±æ€§

- `$t(key, params)` - ç¿»è¯‘æ–‡æœ¬
- `$d(date, format)` - æ ¼å¼åŒ–æ—¥æœŸ
- `$n(number, format)` - æ ¼å¼åŒ–æ•°å­—

## æµ‹è¯•

### æ‰‹åŠ¨æµ‹è¯•æ­¥éª¤

1. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
   ```bash
   pnpm dev
   ```

2. è®¿é—®åº”ç”¨ `http://localhost:3000`

3. ç‚¹å‡»è¯­è¨€åˆ‡æ¢å™¨ï¼Œåˆ‡æ¢ä¸­è‹±æ–‡

4. éªŒè¯ä»¥ä¸‹é¡µé¢:
   - é¦–é¡µ (/)
   - ç”Ÿæˆé¡µé¢ (/generate)
   - è®¾ç½®é¡µé¢ (/settings)
   - æ–‡æ¡£é¡µé¢ (/documents)

5. åˆ·æ–°é¡µé¢ï¼Œç¡®è®¤è¯­è¨€è®¾ç½®è¢«ä¿ç•™

### è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆå¾…å®ç°ï¼‰

```typescript
// ç¤ºä¾‹æµ‹è¯•ç”¨ä¾‹
describe('i18n', () => {
  it('should switch language', async () => {
    const { locale, setLocale } = useI18n()

    await setLocale('en')
    expect(locale.value).toBe('en')

    await setLocale('zh-CN')
    expect(locale.value).toBe('zh-CN')
  })
})
```

## è´¡çŒ®æŒ‡å—

### æ·»åŠ æ–°ç¿»è¯‘é”®

1. åœ¨ `i18n/lang/zh-CN.json` å’Œ `i18n/lang/en.json` ä¸­åŒæ—¶æ·»åŠ ç¿»è¯‘
2. éµå¾ªç°æœ‰çš„é”®å‘½åè§„èŒƒ
3. ç¡®ä¿ç¿»è¯‘å‡†ç¡®ä¸”ç¬¦åˆä¸Šä¸‹æ–‡

### ä»£ç å®¡æŸ¥æ¸…å•

- [ ] æ‰€æœ‰ç¡¬ç¼–ç æ–‡æœ¬å·²æ›¿æ¢ä¸º `$t()` æˆ– `t()`
- [ ] ä¸­è‹±æ–‡ç¿»è¯‘é”®ä¸€ä¸€å¯¹åº”
- [ ] ç¿»è¯‘æ–‡æœ¬å‡†ç¡®ä¸”ç¬¦åˆè¯­å¢ƒ
- [ ] ä½¿ç”¨ shadcn/ui ç»„ä»¶ï¼ˆä¸ä½¿ç”¨å…¶ä»– UI åº“ï¼‰
- [ ] ä»£ç é€šè¿‡ ESLint æ£€æŸ¥

## ç›¸å…³èµ„æº

- [Nuxt i18n å®˜æ–¹æ–‡æ¡£](https://i18n.nuxtjs.org/)
- [Vue I18n æ–‡æ¡£](https://vue-i18n.intlify.dev/)
- [ICU æ¶ˆæ¯æ ¼å¼](https://unicode-org.github.io/icu/userguide/format_parse/messages/)

## æ›´æ–°æ—¥å¿—

### v1.0.0 (2026-02-04)

- âœ… åˆå§‹åŒ– @nuxtjs/i18n æ¨¡å—
- âœ… åˆ›å»ºä¸­è‹±æ–‡ç¿»è¯‘æ–‡ä»¶
- âœ… å®ç°è¯­è¨€åˆ‡æ¢ç»„ä»¶
- âœ… ç¿»è¯‘æ‰€æœ‰æ ¸å¿ƒé¡µé¢å’Œç»„ä»¶
- âœ… Cookie æŒä¹…åŒ–æ”¯æŒ
- âœ… æµè§ˆå™¨è¯­è¨€æ£€æµ‹
